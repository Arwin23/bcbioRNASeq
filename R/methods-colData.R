#' Column Data
#'
#' Improved assignment method support for a `bcbioRNASeq` object.
#'
#' This method support will also update the nested [colData()] inside the
#' `assays` slot.
#'
#' @name colData
#'
#' @importFrom SummarizedExperiment colData colData<-
#'
#' @inheritParams general
#' @param return Return as "`data.frame`" or "`DataFrame`".
#'
#' @return Data describing the columns of the object.
#'
#' @seealso `help("colData", "SummarizedExperiment")`
#'
#' @examples
#' load(system.file("extdata/bcb.rda", package = "bcbioRNASeq"))
#'
#' # Assignment method support
#' colData <- colData(bcb)
#' # All columns will be coerced to factors
#' colData[["age"]] <- c(14L, 30L, 14L, 30L)
#' colData(bcb) <- colData
#' colData(bcb) %>% glimpse()
#'
#' # These internal objects will also get updated
#' assays(bcb)[["rlog"]] %>% colData() %>% glimpse()
#' assays(bcb)[["vst"]] %>% colData() %>% glimpse()
NULL



# Constructors =================================================================
#' @importFrom basejump sanitizeColData
`.colData<-` <- function(x, ..., value) {
    validObject(x)
    assert_are_identical(colnames(x), rownames(value))
    value <- as(value, "DataFrame")
    value <- sanitizeColData(value)
    assert_has_dimnames(value)
    slot(x, "colData") <- value
    x
}



# Methods ======================================================================
#' @rdname colData
#' @export
setMethod(
    "colData",
    signature("bcbioRNASeq"),
    function(x, return = c("data.frame", "DataFrame")) {
        return <- match.arg(return)
        data <- slot(x, "colData")
        as(data, return)
    }
)



# Assignment Methods ===========================================================
#' @rdname colData
#' @export
setMethod(
    "colData<-",
    signature(
        x = "bcbioRNASeq",
        value = "data.frame"
    ),
    `.colData<-`
)



#' @rdname colData
#' @export
setMethod(
    "colData<-",
    signature(
        x = "bcbioRNASeq",
        value = "DataFrame"
    ),
    `.colData<-`
)
